<!DOCTYPE html>
<!--
Crafted with ♥ by Geert Barentsen, Thomas Barclay & Knicole colon at NASA Ames
in August 2015, using pelican-bootstrap and flatly.
-->
<html lang="en"
>

<head>
    <title>LightCurve objects - TESS Science Support Center</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--Custom meta data-->

    <meta name="dc.title" content="NASA - TESS Science Support Center" />
    <meta name="dc.format" content="text/html" />
    <meta name="dc.date.modified" content="2021-08-19" />
    <meta name="dc.language" content="en" />
    <meta name="dc.description" content="Resources and Information for Users of TESS Data" />
    <meta name="dc.identifier" content="https://heasarc.gsfc.nasa.gov/docs/tess/" />
    <meta name="dc.audience" content="Astronomers, Astrophysicists, Scientists, Researchers" />
    <meta name="dc.subject.discipline" content="Astrophysics, Astronomy" />
    <meta name="orgcode" content="667">
    <meta name="rno" content="Thomas.Barclay">
    <meta name="content-owner" content="Thomas.Barclay">
    <meta name="webmaster" content="Thomas.Barclay">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:description" content="Transiting Exoplanet Survey Satellite is a NASA Mission to Study Stars, Planets and Galaxies." />
    <meta name="twitter:title" content="NASA - TESS Science Support Center" />
    <meta name="twitter:site" content="@NASA_TESS" />
    <meta name="twitter:creator" content="@NASA_TESS" />
    <meta name="twitter:image" content="https://heasarc.gsfc.nasa.gov/docs/tess/images/logo-for-twitter.jpeg" />


    <link href="./images/favicon.png" rel="icon">

<link rel="canonical" href="./pages/lightcurve-objects.html">

        <meta name="author" content="Thomas Barclay" />
        <meta name="description" content="Understanding LightCurve objects Learning goals In our TargetPixelFile tutorial we learned, how to obtain data files for our objects of interest and how to examine the metadata stored in the headers. In this tutorial we will learn the following, - How to use Lightkurve to create a TESSLightCurve object. - How to …" />

    <meta property="og:site_name" content="TESS" />
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="LightCurve objects"/>
    <meta property="og:url" content="./pages/lightcurve-objects.html"/>
    <meta property="og:description" content="Understanding LightCurve objects Learning goals In our TargetPixelFile tutorial we learned, how to obtain data files for our objects of interest and how to examine the metadata stored in the headers. In this tutorial we will learn the following, - How to use Lightkurve to create a TESSLightCurve object. - How to …" />
        <meta property="og:image"
              content="./images/logo-for-twitter.jpeg"/>


    <!-- Why use Helvetica Neue when you can have Lato? -->
    <!-- Why use Lato when you can have Nunito? -->
    <link href="./theme/css/nunito.css" rel="stylesheet">

    <!-- Bootstrap -->
        <link rel="stylesheet" href="./theme/css/bootstrap.cosmo.min.css" type="text/css"/>
    <link href="./theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="./theme/css/exoplanet_archive_icons.css" rel="stylesheet">
    <link href="./theme/css/mission_icons.css" rel="stylesheet">
<!--     <link href="./theme/css/photobanner.css" rel="stylesheet">
    <link href="./theme/css/slide-container.css" rel="stylesheet">
    <link href="./theme/css/slide-transition.css" rel="stylesheet"> 
    <link href="./theme/css/slide-transition2.css" rel="stylesheet">  -->
    
    <link href="./theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="./theme/css/style.css" type="text/css"/>

    <link href="./feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="TESS ATOM Feed"/>
    <link href="./feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="TESS RSS Feed"/>

</head>
<body>

<!-- Print a warning message that this is not the official site -->
<div class="container container-wide" style="background-color: #d35400; color: white; padding: 1.5em; font-weight: bold;">
  <div class="container">
   <i class="fa fa-warning fa-lg fa-margin"></i>
    This is the development version of the TESS Science Support Center website.
    For the live website, visit <a href="https://heasarc.gsfc.nasa.gov/docs/tess/">https://heasarc.gsfc.nasa.gov/docs/tess</a>
  </div>
</div>

<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">

  <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="./" class="navbar-brand">
<img src="./images/NASA_logo_vector_lg.png" width="32"/> TESS            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav navbar-nav">
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Mission <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="./objectives.html">Objectives</a></li>
                                <li><a href="./the-tess-space-telescope.html">Telescope</a></li>
                                <li><a href="./primary.html">Primary mission</a></li>
                                <li><a href="./extended.html">Extended mission</a></li>
                                <li><a href="./faq.html">FAQ</a></li>
                                <li><a href="./citizenscience.html">Citizen Science</a></li>
                                <li><a href="./gallery.html">Outreach resources</a></li>
                                <li><a href="./publications.html">Publications</a></li>
                                <li><a href="./media.html">Media Request</a></li>
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Data & tools <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="./data-handling.html">Data pipeline</a></li>
                                <li><a href="./data-products.html">Data products</a></li>
                                <li><a href="./data-access.html">Data access</a></li>
                                <li><a href="./data-analysis-tools.html">Data analysis tools</a></li>
                                <li><a href="./community.html">Community products</a></li>
                                <li><a href="./community-tools.html">Community tools</a></li>
                                <li><a href="./documentation.html">Documentation</a></li>
                                <li><a href="./data_release_notes.html">Data release notes</a></li>
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Observations <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="./observing-technical.html">Technical details</a></li>
                                <li><a href="./sector.html">Sector dates</a></li>
                                <li><a href="./approved-programs.html">Approved GI programs</a></li>
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Proposing <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="./proposing-investigations.html">Guest Investigator Proposals</a></li>
                                <li><a href="./proposal-tools.html">Proposal & observation tools</a></li>
                                <li><a href="./ddt.html">Director's Discretionary Target program</a></li>
                                <li><a href="./proposal-templates.html">Proposal templates</a></li>
                            </ul>
                        </li>
            </ul>
            
            <ul class="nav navbar-nav">
                <li>
                    <a href="./helpdesk.html"><i class="fa fa-info-circle fa-lg"></i> Helpdesk</a>
                </li>
            </ul>
            
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->

<div class="container">
    <div class="row">
        <div class="col-lg-12">

    <div class="col-sm-12">
        <section id="content" class="body">
            <h1 class="entry-title">LightCurve objects</h1>
            <div class="entry-content">
                <div class="section" id="understanding-lightcurve-objects">
<h2>Understanding LightCurve objects</h2>
<div class="section" id="learning-goals">
<h3>Learning goals</h3>
<p>In our <a class="reference external" href="Target-Pixel-File-Tutorial.html">TargetPixelFile tutorial</a> we
learned, how to obtain data files for our objects of interest and how to
examine the <tt class="docutils literal">metadata</tt> stored in the headers.</p>
<p>In this tutorial we will learn the following, - How to use <em>Lightkurve</em>
to create a
<a class="reference external" href="https://docs.lightkurve.org/api/lightkurve.lightcurve.TessLightCurve.html#lightkurve.lightcurve.TessLightCurve">TESSLightCurve</a>
object. - How to examine the object data, and understand its format. -
What is simple aperture photometry (SAP). - How to plot a light curve.</p>
</div>
<div class="section" id="what-is-lightcurve-object">
<h3>What is LightCurve object?</h3>
<p>You can create a <tt class="docutils literal">TESSLightCurve</tt> object from a <tt class="docutils literal">TargetPixelFile</tt>
(TPF) object using Simple Aperture Photometry (SAP).</p>
</div>
<div class="section" id="what-is-simple-aperture-photometry-sap">
<h3>What is Simple Aperture Photometry (SAP)?</h3>
<p>Aperture Photometry is the act of summing up the values of all the
pixels in a pre-defined aperture as a function of time. By carefully
choosing the shape of the aperture mask, you can avoid nearby
contaminants or improve the strength of the specific signal you are
trying to measure relative to the background.</p>
<p>The SAP light curve is a pixel summation time-series of all calibrated
flux falling within the optimal aperture, as stored and defined in the
TPF.</p>
<p>In this notebook we will demonstrate, let’s create a <tt class="docutils literal">TESSLightCurve</tt>
from a <tt class="docutils literal">TESSTargetPixelFile</tt>.</p>
</div>
<div class="section" id="imports">
<h3>Imports</h3>
<p>This tutorial requires that you import <em>Lightkurve</em>.</p>
<pre class="code ipython3 literal-block">
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">lightkurve</span> <span class="k">as</span> <span class="nn">lk</span>
</pre>
</div>
<div class="section" id="defining-terms">
<h3>Defining terms</h3>
<ul class="simple">
<li>Target Pixel File (TPF): A file containing the original CCD pixel
observations from which light curves are extracted.</li>
<li>LightCurve Object: Obtained from a TPF and contains light curve
information derived using simple aperture photometry.</li>
<li>Cadence: The rate at which TESS photometric observations are stored.</li>
<li>Sector: One of TESS’s 27 (to date) observing periods, approximately
~27 days in duration.</li>
<li>Simple Aperture Photometry (SAP): The act of summing all pixel values
in a pre-defined aperture as a function of time.</li>
</ul>
</div>
<div class="section" id="downloading-the-tpf">
<h3>Downloading the TPF</h3>
<p>For this tutorial we will use the <a class="reference external" href="https://arxiv.org/pdf/1903.08017.pdf">L 98-59
System</a> focusing on planet c.</p>
<p>First we search for appropriate Target Pixel Files on
<a class="reference external" href="https://archive.stsci.edu/tess/">MAST</a> using the
<a class="reference external" href="https://docs.lightkurve.org/api/lightkurve.search.search_targetpixelfile.html?highlight=search_targetpixelfile">search_targetpixelfile</a>
function.</p>
<pre class="code ipython3 literal-block">
<span class="n">search</span> <span class="o">=</span> <span class="n">lk</span><span class="o">.</span><span class="n">search_targetpixelfile</span><span class="p">(</span><span class="s1">'TIC 307210830 c'</span><span class="p">)</span>
<span class="n">search</span>
</pre>
SearchResult containing 7 data products.

<table id="table140359681659232">
<thead><tr><th>#</th><th>observation</th><th>author</th><th>target_name</th><th>productFilename</th><th>distance</th></tr></thead>
<tr><td>0</td><td>TESS Sector 2</td><td>SPOC</td><td>307210830</td><td>tess2018234235059-s0002-0000000307210830-0121-s_tp.fits</td><td>0.0</td></tr>
<tr><td>1</td><td>TESS Sector 5</td><td>SPOC</td><td>307210830</td><td>tess2018319095959-s0005-0000000307210830-0125-s_tp.fits</td><td>0.0</td></tr>
<tr><td>2</td><td>TESS Sector 8</td><td>SPOC</td><td>307210830</td><td>tess2019032160000-s0008-0000000307210830-0136-s_tp.fits</td><td>0.0</td></tr>
<tr><td>3</td><td>TESS Sector 9</td><td>SPOC</td><td>307210830</td><td>tess2019058134432-s0009-0000000307210830-0139-s_tp.fits</td><td>0.0</td></tr>
<tr><td>4</td><td>TESS Sector 10</td><td>SPOC</td><td>307210830</td><td>tess2019085135100-s0010-0000000307210830-0140-s_tp.fits</td><td>0.0</td></tr>
<tr><td>5</td><td>TESS Sector 11</td><td>SPOC</td><td>307210830</td><td>tess2019112060037-s0011-0000000307210830-0143-s_tp.fits</td><td>0.0</td></tr>
<tr><td>6</td><td>TESS Sector 12</td><td>SPOC</td><td>307210830</td><td>tess2019140104343-s0012-0000000307210830-0144-s_tp.fits</td><td>0.0</td></tr>
</table><p>Our object of interest can be found in seven sectors. Let’s take the
first sector, sector 2 and download that.</p>
<pre class="code ipython3 literal-block">
<span class="n">tpf</span> <span class="o">=</span> <span class="n">lk</span><span class="o">.</span><span class="n">search_targetpixelfile</span><span class="p">(</span><span class="s1">'TIC 307210830 c'</span><span class="p">,</span> <span class="n">sector</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>
<span class="n">tpf</span>
</pre>
<pre class="literal-block">
TessTargetPixelFile(TICID: 307210830)
</pre>
</div>
<div class="section" id="creating-and-analizing-the-lightcurve-object">
<h3>Creating and analizing the LightCurve object</h3>
<p>Great we now have our TPF! Lets convert this TPF into a
<tt class="docutils literal">TessLightCurve</tt> object using the
<a class="reference external" href="https://docs.lightkurve.org/api/lightkurve.targetpixelfile.TessTargetPixelFile.html#lightkurve.targetpixelfile.TessTargetPixelFile.to_lightcurve">to_lightcurve</a>
function.</p>
<p>To create the SAP lightcurve we will pass an <strong>aperture_mask</strong> to the
<tt class="docutils literal">to_lightcurve</tt> function. The default is to use the
<a class="reference external" href="https://heasarc.gsfc.nasa.gov/docs/tess/pipeline.html">SPOC</a>
pipeline aperture, which sums all the pixels in its defined mask.</p>
<pre class="code ipython3 literal-block">
<span class="n">lc</span> <span class="o">=</span> <span class="n">tpf</span><span class="o">.</span><span class="n">to_lightcurve</span><span class="p">(</span><span class="n">aperture_mask</span><span class="o">=</span><span class="n">tpf</span><span class="o">.</span><span class="n">pipeline_mask</span><span class="p">)</span>
<span class="n">lc</span>
</pre>
<i>TessLightCurve targetid=307210830 length=18317</i>
<table id="table140359674564792" class="table-striped table-bordered table-condensed">
<thead><tr><th>time</th><th>flux</th><th>flux_err</th><th>centroid_col</th><th>centroid_row</th><th>cadenceno</th><th>quality</th></tr></thead>
<thead><tr><th></th><th>electron / s</th><th>electron / s</th><th>pix</th><th>pix</th><th></th><th></th></tr></thead>
<thead><tr><th>object</th><th>float32</th><th>float32</th><th>float64</th><th>float64</th><th>int32</th><th>int32</th></tr></thead>
<tr><td>1354.1088231272427</td><td>21566.349609375</td><td>16.116119384765625</td><td>664.6090864691554</td><td>339.4764484490161</td><td>91191</td><td>0</td></tr>
<tr><td>1354.1102119888994</td><td>21563.88671875</td><td>16.118038177490234</td><td>664.6261723169015</td><td>339.46842003296774</td><td>91192</td><td>0</td></tr>
<tr><td>1354.112989712153</td><td>21475.162109375</td><td>16.089221954345703</td><td>664.606630403678</td><td>339.4604662968742</td><td>91194</td><td>0</td></tr>
<tr><td>1354.1143785738097</td><td>21583.30859375</td><td>16.12527084350586</td><td>664.6414481151693</td><td>339.4832617761526</td><td>91195</td><td>0</td></tr>
<tr><td>1354.1157674355243</td><td>21575.640625</td><td>16.121679306030273</td><td>664.6354584758038</td><td>339.4735678477034</td><td>91196</td><td>0</td></tr>
<tr><td>1354.1171562971804</td><td>21563.1015625</td><td>16.115528106689453</td><td>664.6334974032626</td><td>339.472138768046</td><td>91197</td><td>0</td></tr>
<tr><td>1354.1185451588947</td><td>21552.935546875</td><td>16.112627029418945</td><td>664.625177003332</td><td>339.46675685339096</td><td>91198</td><td>0</td></tr>
<tr><td>1354.1199340205515</td><td>21532.90234375</td><td>16.10567855834961</td><td>664.6301979867933</td><td>339.4699372207359</td><td>91199</td><td>0</td></tr>
<tr><td>1354.1213228822667</td><td>21533.828125</td><td>16.105731964111328</td><td>664.6262018316135</td><td>339.46553338843</td><td>91200</td><td>0</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>1381.5001032523294</td><td>21262.494140625</td><td>16.291688919067383</td><td>664.5744500858646</td><td>339.3513278016392</td><td>110913</td><td>0</td></tr>
<tr><td>1381.5014921207378</td><td>21289.828125</td><td>16.302898406982422</td><td>664.5797804765874</td><td>339.3491398520347</td><td>110914</td><td>0</td></tr>
<tr><td>1381.5028809891458</td><td>21266.3515625</td><td>16.29288673400879</td><td>664.5790106545255</td><td>339.3513312907625</td><td>110915</td><td>0</td></tr>
<tr><td>1381.5042698574382</td><td>21234.845703125</td><td>16.279603958129883</td><td>664.5730941550626</td><td>339.3555631381705</td><td>110916</td><td>0</td></tr>
<tr><td>1381.5056587258466</td><td>21244.953125</td><td>16.281909942626953</td><td>664.5782007755507</td><td>339.3468316465567</td><td>110917</td><td>0</td></tr>
<tr><td>1381.5070475942555</td><td>21210.7578125</td><td>16.267162322998047</td><td>664.5770708377116</td><td>339.3442359060069</td><td>110918</td><td>0</td></tr>
<tr><td>1381.508436462548</td><td>21231.01171875</td><td>16.27315330505371</td><td>664.5786574675517</td><td>339.34217245510536</td><td>110919</td><td>0</td></tr>
<tr><td>1381.5098253309563</td><td>21250.466796875</td><td>16.277507781982422</td><td>664.5722297003167</td><td>339.3513272975753</td><td>110920</td><td>0</td></tr>
<tr><td>1381.5112141992488</td><td>21236.35546875</td><td>16.2720890045166</td><td>664.582152318805</td><td>339.3452178427711</td><td>110921</td><td>0</td></tr>
<tr><td>1381.5126030676577</td><td>21265.83984375</td><td>16.278945922851562</td><td>664.5729270180528</td><td>339.349710493043</td><td>110922</td><td>0</td></tr>
</table><p>We’ve built a new <tt class="docutils literal">TESSLightCurve</tt> object called <tt class="docutils literal">lc</tt>. Note although
we used the SPOC aperture mask you can pass your own aperture,
(specified by a boolean <tt class="docutils literal">numpy</tt> array) as seen in the <a class="reference external" href="Making-Custom-Apertures-Tutorial.html">Making Custom
Apertures tutorial</a>.</p>
<p>The above table displays all the light curve data.</p>
</div>
<div class="section" id="metadata">
<h3>Metadata</h3>
<p><tt class="docutils literal">TESSLightCurve</tt> objects have many useful functions that you can use.
As with a TPF you can access the meta data very simply.</p>
<pre class="code ipython3 literal-block">
<span class="n">lc</span><span class="o">.</span><span class="n">sector</span>
</pre>
<pre class="literal-block">
2
</pre>
<p>Of course you still have access to time and flux attributes. In a
light curve, there is only one flux point for every cadence.</p>
<pre class="code ipython3 literal-block">
<span class="n">lc</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">lc</span><span class="o">.</span><span class="n">time</span>
</pre>
<pre class="literal-block">
(&lt;Quantity [21566.35 , 21563.887, 21475.162, ..., 21250.467, 21236.355,
            21265.84 ] electron / s&gt;,
 &lt;Time object: scale='tdb' format='btjd' value=[1354.10882313 1354.11021199 1354.11298971 ... 1381.50982533 1381.5112142
  1381.51260307]&gt;)
</pre>
<p>You can also check the Combined Differential Photometric Precision
(CDPP) RMS per transit duration noise metric (see <a class="reference external" href="https://iopscience.iop.org/article/10.1088/0067-0049/197/1/6/pdf">Gilliland et al.,
2011</a>
for more details) of the light curve using the built in method
<a class="reference external" href="https://docs.lightkurve.org/api/lightkurve.lightcurve.FoldedLightCurve.html#lightkurve.lightcurve.FoldedLightCurve.estimate_cdpp">estimate_cdpp</a>:</p>
<pre class="code ipython3 literal-block">
<span class="n">lc</span><span class="o">.</span><span class="n">estimate_cdpp</span><span class="p">()</span>
</pre>
<div class="formula">
300.86106 <span class="mathrm"> ppm</span>
</div>
<p>The above is the Savitzky-Golay CDPP noise metric in units
parts-per-million (ppm)</p>
</div>
<div class="section" id="plotting-the-light-curve">
<h3>Plotting the light curve</h3>
<p>We can now use the built in <tt class="docutils literal">plot</tt> function on the <tt class="docutils literal">TESSLightCurve</tt>
object to plot the time series. You can pass <tt class="docutils literal">plot</tt> any keywords you
would normally pass to
<a class="reference external" href="https://matplotlib.org/3.1.3/api/_as_gen/matplotlib.pyplot.plot.html">matplotlib.pyplot.plot</a>.</p>
<pre class="code ipython3 literal-block">
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">lc</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre>
<img alt="" src="images/LightCurve-objects_files/LightCurve-objects_23_0.png" />
</div>
<div class="section" id="manipulating-the-light-curve">
<h3>Manipulating the light curve</h3>
<p>There are a set of useful functions in
<a class="reference external" href="https://docs.lightkurve.org/api/lightkurve.lightcurve.LightCurve.html#lightkurve.lightcurve.LightCurve">LightCurve</a>
objects which you can use to work with the data. These include: *
<a class="reference external" href="https://docs.lightkurve.org/api/lightkurve.lightcurve.LightCurve.html#lightkurve.lightcurve.LightCurve.flatten">flatten()</a>:
Remove long term trends using a <a class="reference external" href="https://en.wikipedia.org/wiki/Savitzky%E2%80%93Golay_filter">Savitzky–Golay
filter</a>
*
<a class="reference external" href="https://docs.lightkurve.org/api/lightkurve.lightcurve.LightCurve.html#lightkurve.lightcurve.LightCurve.remove_outliers">remove_outliers()</a>:
Remove outliers using simple sigma clipping *
<a class="reference external" href="https://docs.lightkurve.org/api/lightkurve.lightcurve.LightCurve.html#lightkurve.lightcurve.LightCurve.remove_nans">remove_nans()</a>:
Remove infinite or NaN values (these can occur during thruster firings)
*
<a class="reference external" href="https://docs.lightkurve.org/api/lightkurve.lightcurve.LightCurve.html#lightkurve.lightcurve.LightCurve.fold">fold()</a>:
Fold the data at a particular period *
<a class="reference external" href="https://docs.lightkurve.org/api/lightkurve.lightcurve.LightCurve.html#lightkurve.lightcurve.LightCurve.bin">bin()</a>:
Reduce the time resolution of the array, taking the average value in
each bin.</p>
<p>We can use these simply on a light curve object</p>
<pre class="code ipython3 literal-block">
<span class="n">flat_lc</span> <span class="o">=</span> <span class="n">lc</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">window_length</span><span class="o">=</span><span class="mi">401</span><span class="p">)</span>
<span class="n">flat_lc</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre>
<img alt="" src="images/LightCurve-objects_files/LightCurve-objects_25_0.png" />
<div class="section" id="folding-the-light-curve">
<h4>Folding the light curve</h4>
<p>From the <a class="reference external" href="https://arxiv.org/pdf/1903.08017.pdf">L 98-59 System</a> paper
we know that planet c has a time corresponding to zero phase (noted as
epoch_time) of 1367.2755 BTJD days and period of 3.690621 days. We can
use the <tt class="docutils literal">fold()</tt> function to find the transit in our data.</p>
<pre class="code ipython3 literal-block">
<span class="n">folded_lc</span> <span class="o">=</span> <span class="n">flat_lc</span><span class="o">.</span><span class="n">fold</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="mf">3.690621</span><span class="p">,</span>  <span class="n">epoch_time</span><span class="o">=</span><span class="mf">1367.2755</span><span class="p">)</span>
<span class="n">folded_lc</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre>
<img alt="" src="images/LightCurve-objects_files/LightCurve-objects_27_0.png" />
</div>
<div class="section" id="binning-data">
<h4>Binning data</h4>
<p>Often to see a trend it can be beneficial to bin the data, this can be
achieved via the <tt class="docutils literal">bin()</tt> function.</p>
<pre class="code ipython3 literal-block">
<span class="n">binned_lc</span> <span class="o">=</span> <span class="n">folded_lc</span><span class="o">.</span><span class="n">bin</span><span class="p">(</span><span class="n">time_bin_size</span><span class="o">=</span><span class="mf">0.025</span><span class="p">)</span>
<span class="n">binned_lc</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre>
<img alt="" src="images/LightCurve-objects_files/LightCurve-objects_29_0.png" />
<p>We can now see our transit very clearly! Note that we can achieve the
same plot from our data using one line of code instead of several, see
below.</p>
<pre class="code ipython3 literal-block">
<span class="n">lc</span><span class="o">.</span><span class="n">remove_nans</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">window_length</span><span class="o">=</span><span class="mi">401</span><span class="p">)</span><span class="o">.</span><span class="n">fold</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="mf">3.690621</span><span class="p">,</span>  <span class="n">epoch_time</span><span class="o">=</span><span class="mf">1367.2755</span><span class="p">)</span><span class="o">.</span><span class="n">bin</span><span class="p">(</span><span class="n">time_bin_size</span><span class="o">=</span><span class="mf">0.025</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre>
<img alt="" src="images/LightCurve-objects_files/LightCurve-objects_31_0.png" />
</div>
</div>
</div>

            </div>
        </section>
    </div>

        </div>
    </div>
</div>

<div class="container container-wide" style="margin-top: 1.5em;">
  <footer>

     <div class="container">

      <!-- Partner logos -->  
      <div class="row">
        <div class="col-md-10"> 
          <a href="http://tess.mit.edu/"><img src="./images/partners/mit-logo.png" width="80" alt="MIT Logo"></a> &nbsp;&nbsp;&nbsp;
         <a href="http://www.nasa.gov/"><img src="./images/NASA_logo_vector_lg.png" width="60" alt="NASA Logo"></a> &nbsp;&nbsp;&nbsp;
         <a href="https://www.cfa.harvard.edu/"><img src="./images/partners/CfA_Horizontal_CMYK.png" width="176" alt="CfA Logo"></a> &nbsp;&nbsp;&nbsp;
<!--          <a href="https://www.ll.mit.edu/"><img src="./images/partners/lincoln-laboratory.png" width="50" alt="Lincoln Labs Logo"></a> &nbsp;&nbsp;&nbsp; -->
         <a href="https://http://www.northropgrumman.com/"><img src="./images/partners/Northrop_Grumman.png" width="176" alt="Orbital ATK Logo"></a> &nbsp;&nbsp;&nbsp;
         <a href="http://www.stsci.edu/"><img src="./images/partners/stsci_logo2.png" width="110" alt="STScI Logo"></a> 
        </div>
      </div>

      
      <!-- Related websites -->  
      <div class="row">
        <div class="col-xs-12">
          <h5><i class="fa fa-external-link"></i><span class="icon-label">Related websites:</span></h5>
          <a href="https://nasa.gov/tess" target="_blank">
                  News, Media, and Education Resources
              </a>
          <br/>
          <a href="http://tess.mit.edu/" target="_blank">
                  TESS @ MIT
              </a>
          <br/>
          <a href="http://archive.stsci.edu/tess" target="_blank">
                  TESS @ MAST
              </a>
          <br/>
          <a href="https://heasarc.gsfc.nasa.gov/" target="_blank">
                  High Energy Astrophysics Science Archive Research Center
              </a>
          <br/>
          <a href="http://exoplanetarchive.ipac.caltech.edu" target="_blank">
                  NASA Exoplanet Archive @ IPAC
              </a>
          <br/>
        </div>
      </div>

      <!-- NASA logo and notices -->
      <div class="row" style="margin-top:2em;">
         <div class="col-md-10"> <a href="http://www.nasa.gov/"><img src="./images/NASA_logo_vector_lg.png" width="30" alt="NASA Logo"></a> 
         Last modified: Wed 18 August 2021
            &middot; Editor: Thomas Barclay &middot; NASA Official: Patricia T Boyd 
            &middot; <a href="http://www.nasa.gov/about/highlights/HP_Privacy.html">Privacy Policy and Important Notices</a><p></p>         </div>
         <div class="col-md-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
    </div>

  </footer>
</div>
<script src="./theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="./theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="./theme/js/respond.min.js"></script>

    <script src="./theme/js/bodypadding.js"></script>
<!-- Analytics scripts -->


</body>
</html>